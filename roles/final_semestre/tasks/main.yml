---
#Linux

# Debian e Ubuntu
# - name: Apaga todas as máquinas virtuais 
# - hosts: laboratorios_lin
#   tasks:
#     - name: Remove arquivos da pasta Virtualbox
#       raw: rm -rf /opt/vms/'VirtualBox VMs'/*
#     - name: Remove configurações das máquinas virtuais
#       raw: rm -rf /opt/vms/.config/VirtualBox/*
#   roles:
#     - criar_vm
# - hosts: laboratorios_lin
#   tasks:
#     - name: Reinicia o computador
#       raw: reboot

# - name: Cria pasta compartilhada entre sistemas - Linux
#   file:
#     state: directory
#     path: /media/aluno/trabalhos/
#     owner: aluno
#     group: aluno
#   when: ansible_os_family == 'Debian'

# Windows

- name: Remove a profile for a still valid account
  community.windows.win_user_profile:
    username: aluno
    state: absent
  when: ansible_os_family == 'Windows'

- name: Remove conta do aluno
  win_user:
    name: aluno
    state: absent
  when: ansible_os_family == 'Windows'

- name: Remove profile do aluno
  win_user_profile:
    name: aluno
    state: absent
    remove_multiple: yes
  when: ansible_os_family == 'Windows'

- name: Remove a pasta do aluno
  win_file:
    path: C:\Users\aluno
    state: absent
  when: ansible_os_family == 'Windows'

- name: cria usuário aluno
  win_user:
    name: aluno
    password: aluno
    password_expired: no
    state: present
    user_cannot_change_password: yes
    groups:
      - "Usuários"
  when: ansible_os_family == 'Windows'

  # - name: Instala todas as Atualizações #### A máquina pode reiniciar
  # ansible.windows.win_updates:
  #   category_names: '*'
  # when: ansible_os_family == 'Windows'
